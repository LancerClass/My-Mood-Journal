<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<title>My Mood Journal</title>
<link rel="manifest" href="manifest.json" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root{
 --theme-bg:#e8f0e8; --theme-accent:#9fbfa5; --theme-text:#2b2b2b;
}
body{
 margin:0;padding:env(safe-area-inset-top) env(safe-area-inset-right) calc(env(safe-area-inset-bottom)+10px) env(safe-area-inset-left);
 font-family:Arial, sans-serif;background:var(--theme-bg);color:var(--theme-text);transition:background 0.4s ease;
}
nav{display:flex;justify-content:space-around;position:fixed;bottom:0;left:0;right:0;background:#fff;padding:10px 0;border-top:1px solid #ccc;z-index:10;}
nav button{background:none;border:none;font-size:16px;padding:10px;color:#666;}
nav button.active{color:var(--theme-accent);font-weight:bold;}
section{display:none;padding:20px;}section.active{display:block;}
.card{background:#fff;margin:10px 0;padding:15px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);} 
#themePicker{margin-top:10px;}
.fab{position:fixed;bottom:calc(70px + env(safe-area-inset-bottom));right:20px;background:var(--theme-accent);color:white;width:55px;height:55px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:30px;box-shadow:0 4px 8px rgba(0,0,0,0.2);} 
#micBtn{font-size:20px;margin-left:10px;}
#pinScreen{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;}
#pinScreen input{font-size:26px;padding:10px;text-align:center;border-radius:10px;width:150px;letter-spacing:12px;}
</style>
</head>
<body>
<div id="pinScreen" style="display:none;">
 <h2 style="color:white;">Enter PIN</h2>
 <input id="pinInput" maxlength="4" />
</div>
<nav>
 <button class="tabBtn active" data-tab="log">Log</button>
 <button class="tabBtn" data-tab="charts">Charts</button>
 <button class="tabBtn" data-tab="garden">Garden</button>
 <button class="tabBtn" data-tab="achievements">Achievements</button>
 <button class="tabBtn" data-tab="settings">Settings</button>
</nav>
<section id="log" class="active">
 <div class="card">
 <h2>Add Mood Entry</h2>
 <select id="moodSelect">
 <option>ðŸ˜Š Happy</option><option>ðŸ˜” Sad</option><option>ðŸ˜¡ Angry</option><option>ðŸ˜µ Overwhelmed</option><option>ðŸ˜´ Tired</option><option>ðŸ«¶ Loved</option>
 </select>
 <textarea id="moodNote" placeholder="What happened?" style="width:100%;margin-top:10px;font-size:16px;"></textarea>
 <button id="micBtn">ðŸŽ¤</button>
 <button id="saveEntry">Save</button>
 </div>
 <div id="entries"></div>
</section>
<section id="charts">
 <div class="card"><h2>Entries by Category</h2><canvas id="categoryChart"></canvas></div>
 <div class="card"><h2>Entries by Time of Day</h2><canvas id="timeChart"></canvas></div>
 <div class="card"><h2>Weekly Trend</h2><canvas id="weeklyChart"></canvas></div>
 <div class="card"><h2>Activity Heatmap</h2><canvas id="heatmapChart"></canvas></div>
</section>
<section id="garden">
 <div class="card"><h2>Your Mood Garden</h2><div id="gardenArea" style="font-size:40px;">ðŸŒ±</div></div>
</section>
<section id="achievements">
 <div class="card"><h2>Achievements</h2><ul id="achievementList"></ul></div>
</section>
<section id="settings">
 <div class="card"><h2>Theme Selector</h2>
 <select id="themePicker">
 <option value="sage">Sage</option><option value="pink">Pink</option><option value="lavender">Lavender</option><option value="blue">Sky Blue</option><option value="cocoa">Cocoa</option><option value="dark">Dark</option>
 </select>
 </div>
 <div class="card"><h2>PIN Lock</h2><button id="setPin">Set PIN</button></div>
 <div class="card"><h2>Export</h2><button id="csvExport">Export CSV</button> <button id="pdfExport">Export PDF</button> <button id="jsonExport">Encrypted JSON</button> <input type="file" id="jsonImport" /></div>
 <div class="card"><h2>Reminders</h2><button id="enableReminders">Enable Daily Reminder</button></div>
</section>
<div class="fab" id="fab">+</div>
<script>
// --- Tab Switching ---
const tabs=document.querySelectorAll('.tabBtn');
const sections=document.querySelectorAll('section');
tabs.forEach(btn=>btn.onclick=()=>{
 tabs.forEach(b=>b.classList.remove('active')); btn.classList.add('active');
 sections.forEach(s=>s.classList.remove('active')); document.getElementById(btn.dataset.tab).classList.add('active');
});

// --- Theme System ---
const themes={sage:{bg:'#e8f0e8',accent:'#9fbfa5',text:'#2b2b2b'},pink:{bg:'#ffeaf3',accent:'#ff7fbf',text:'#3a1e2e'},lavender:{bg:'#f3eaff',accent:'#b28dff',text:'#2b1e3a'},blue:{bg:'#e8f4ff',accent:'#7fafff',text:'#1e2e3a'},cocoa:{bg:'#f1e6d8',accent:'#b58b61',text:'#3a2e1e'},dark:{bg:'#1e1e1e',accent:'#7f7f7f',text:'#ffffff'}};
function applyTheme(name){const t=themes[name];for(let v in t){document.documentElement.style.setProperty(`--theme-${v}`,t[v]);}localStorage.setItem('theme',name);} 
let savedTheme=localStorage.getItem('theme'); if(savedTheme)applyTheme(savedTheme);
document.getElementById('themePicker').onchange=e=>applyTheme(e.target.value);
// Auto Dark Mode
let hour=new Date().getHours(); if(hour>=20||hour<6) applyTheme('dark');
// Voice to Text
let rec;if('webkitSpeechRecognition' in window){rec=new webkitSpeechRecognition();rec.continuous=false;rec.lang='en-US';document.getElementById('micBtn').onclick=()=>rec.start();rec.onresult=e=>document.getElementById('moodNote').value=e.results[0][0].transcript;}
// Daily Reminder
if('Notification' in window){document.getElementById('enableReminders').onclick=()=>{Notification.requestPermission().then(p=>{if(p==='granted'){setTimeout(()=>new Notification('How are you feeling today?'),5000);}});}}
// Garden & Achievements
function updateGarden(){let count=JSON.parse(localStorage.getItem('entries')||'[]').filter(e=>e.mood.includes('ðŸ˜Š')||e.mood.includes('ðŸ«¶')).length; let plant='ðŸŒ±'; if(count>5)plant='ðŸŒ¿'; if(count>10)plant='ðŸŒ³'; document.getElementById('gardenArea').innerText=plant;}
function updateAchievements(){let list=document.getElementById('achievementList'); list.innerHTML=''; let entries=JSON.parse(localStorage.getItem('entries')||'[]'); if(entries.length>=5)list.innerHTML+='<li>5 Entries Logged</li>'; if(entries.length>=20)list.innerHTML+='<li>20 Entries Logged</li>';}
// Save Entries
let saveBtn=document.getElementById('saveEntry'); saveBtn.onclick=()=>{let entries=JSON.parse(localStorage.getItem('entries')||'[]'); entries.push({mood:document.getElementById('moodSelect').value,note:document.getElementById('moodNote').value,time:Date.now()}); localStorage.setItem('entries',JSON.stringify(entries)); loadEntries(); updateGarden();updateAchievements(); loadCharts();}
function loadEntries(){let box=document.getElementById('entries'); box.innerHTML=''; let entries=JSON.parse(localStorage.getItem('entries')||'[]'); entries.forEach(e=>{let d=new Date(e.time);box.innerHTML+=`<div class='card'><strong>${e.mood}</strong><br>${e.note}<br><em>${d.toLocaleString()}</em></div>`;});}
loadEntries();
// Chart.js Example
function loadCharts(){let entries=JSON.parse(localStorage.getItem('entries')||'[]');
// Category Chart
let catCtx=document.getElementById('categoryChart').getContext('2d');
let catData={};entries.forEach(e=>{catData[e.mood]=(catData[e.mood]||0)+1;});
new Chart(catCtx,{type:'bar',data:{labels:Object.keys(catData),datasets:[{label:'Entries',data:Object.values(catData),backgroundColor:'var(--theme-accent)'}]}});
// Time Chart
let timeCtx=document.getElementById('timeChart').getContext('2d');
let timeData=[0,0,0,0]; entries.forEach(e=>{let h=new Date(e.time).getHours();if(h<6)timeData[0]++;else if(h<12)timeData[1]++;else if(h<18)timeData[2]++;else timeData[3]++;});
new Chart(timeCtx,{type:'bar',data:{labels:['Night','Morning','Afternoon','Evening'],datasets:[{label:'Entries',data:timeData,backgroundColor:'var(--theme-accent)'}]}});
}
loadCharts();
</script>
</body>
</html>
